<!DOCTYPE html>
    <html>
    <head>
        <title>Meeting Scheduler</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <div id="app">
            <h1>Meeting Scheduler</h1>
            <div id="messages"></div>
            <div id="input-area">
                <input type="text" id="messageInput" placeholder="Describe your meeting..." disabled>
                <button id="sendButton" disabled>Send</button>
            </div>
        </div>

        <style>
            body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #f5f5f5; }
            #app { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
            h1 { color: #333; text-align: center; margin-bottom: 30px; }
            #messages { height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; background-color: #fafafa; border-radius: 4px; }
            #input-area { display: flex; gap: 10px; }
            #messageInput { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; }
            #sendButton { padding: 12px 24px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
            #sendButton:hover:not(:disabled) { background-color: #0056b3; }
            #sendButton:disabled { background-color: #ccc; cursor: not-allowed; }
            .message { margin: 10px 0; padding: 10px; border-radius: 4px; }
            .user-message { background-color: #e3f2fd; border-left: 4px solid #2196f3; }
            .bot-message { background-color: #f1f8e9; border-left: 4px solid #4caf50; }
            .system-message { background-color: #fff3e0; border-left: 4px solid #ff9800; }
            .error-message { background-color: #ffebee; border-left: 4px solid #f44336; }
            .complete-message { background-color: #e8f5e8; border-left: 4px solid #4caf50; font-weight: bold; }
            .final-message { background-color: #e1f5fe; border-left: 4px solid #03a9f4; font-weight: bold; }
        </style>

        <script>
            const sessionId = 'session_' + Date.now();
            let ws = null;
            let isConnected = false;

            function connect() {
                ws = new WebSocket(`ws://localhost:8009/ws/${sessionId}`);
                
                ws.onopen = function(event) {
                    isConnected = true;
                    document.getElementById('messageInput').disabled = false;
                    document.getElementById('sendButton').disabled = false;
                    addMessage('Connected to server', 'system-message');
                };

                ws.onmessage = function(event) {
                    const data = JSON.parse(event.data);
                    
                    switch(data.type) {
                        case 'connected':
                            addMessage(data.message, 'system-message');
                            break;
                        case 'processing':
                        case 'progress':
                            addMessage(data.message, 'system-message');
                            break;
                        case 'question':
                            addMessage(data.message, 'bot-message');
                            break;
                        case 'complete':
                            addMessage(data.message, 'complete-message');
                            if (data.meeting_details) {
                                const details = data.meeting_details;
                                addMessage(`Meeting Details:<br>
                                    ðŸ“§ Recipient: ${details.recipient || 'N/A'}<br>
                                    ðŸ“… Date/Time: ${details.datetime || 'N/A'}<br>
                                    ðŸ“‹ Agenda: ${details.agenda || 'N/A'}`, 'complete-message');
                            }
                            break;
                        case 'final_message':
                            addMessage(data.message, 'final-message');
                            break;
                        case 'error':
                            addMessage('Error: ' + data.message, 'error-message');
                            break;
                        default:
                            console.log('Unknown message type:', data.type);
                            addMessage('Unknown message: ' + JSON.stringify(data), 'system-message');
                            break;
                    }
                };

                ws.onclose = function(event) {
                    isConnected = false;
                    document.getElementById('messageInput').disabled = true;
                    document.getElementById('sendButton').disabled = true;
                    addMessage('Disconnected from server', 'system-message');
                };

                ws.onerror = function(error) {
                    addMessage('Connection error occurred', 'error-message');
                };
            }

            function sendMessage() {
                const input = document.getElementById('messageInput');
                const message = input.value.trim();
                
                if (message && isConnected) {
                    addMessage(message, 'user-message');
                    ws.send(JSON.stringify({ 
                        message: message,
                        user_id: 'web_user',
                        user_name: 'Web User'
                    }));
                    input.value = '';
                }
            }

            function addMessage(message, className) {
                const messagesDiv = document.getElementById('messages');
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${className}`;
                messageDiv.innerHTML = message;
                messagesDiv.appendChild(messageDiv);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }

            // Event listeners
            document.getElementById('sendButton').addEventListener('click', sendMessage);
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Connect on page load
            connect();
        </script>
    </body>
    </html>